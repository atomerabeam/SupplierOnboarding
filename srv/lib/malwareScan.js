const apiMalwareScan = require("./../resources/api-clients/MalwareScanAPI/default-api")

function mediaMalwareScanner(fileContent) {
    let malwarescan = new Promise(async function (resolve, reject) {
        //convert fileContent as Base64 to Binary String
        let binaryString = atob(fileContent)

        // Initialize a request to scan Malware
        let requestBuilder = apiMalwareScan.DefaultApi.createScan(binaryString);
        requestBuilder.addCustomHeaders({ 'Content-Type': 'application/octet-stream' });
        requestBuilder.addCustomHeaders({ 'Accept': 'application/json' });

        //send /scan request 
        let response = await requestBuilder.skipCsrfTokenFetching().execute({ destinationName: 'malwareScanner-destination' });
        resolve(response.malwareDetected);
    });
    return malwarescan;
  }

  module.exports = { mediaMalwareScanner}